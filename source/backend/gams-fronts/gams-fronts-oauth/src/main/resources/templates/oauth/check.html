<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Global Asset Management Services|MOF</title>
    <link rel="icon" th:href="@{/images/favicon.ico}" />
    <link rel="stylesheet" th:href="@{/css/bootstrap.min.css}" />
    <link rel="stylesheet" th:href="@{/css/index.css}" />
    <script th:src="@{/js/jquery.js}"></script>
</head>
<body>
<div class="app-header">
    <a class="link-index">
        <img src="/images/logo.png" class="logo">
    </a>
    <div class="tab-wrapper">
        <a class="register link-register">Open Account</a>
        <span class="divide">|</span>
        <a class="return link-index">Home</a>
    </div>
</div>
<div class="app-container">
    <div class="app-content">
        <div class="left-wrapper">
            <img src="/images/title_border.png" class="title-border">
            <div class="left-txt">MOF Securities</div>
            <div class="left-button">Realize your dream of wealth</div>
        </div>
        <div class="right-wrapper">
            <div class="login-title">Secure Login</div>
            <form id="loginForm" th:action="@{/oauth/authorize}" method="post" class="login-form">
                <div class="login-alert" th:text="${error}"></div>
                <input type="hidden" name="client_id" th:value="${param.client_id}"/>
                <input type="hidden" name="scope" th:value="${param.scope}"/>
                <input type="hidden" name="response_type" th:value="${param.response_type}"/>
                <input type="hidden" name="redirect_uri" th:value="${param.redirect_uri}"/>
                <input type="hidden" name="state" th:value="${param.state}"/>
                <input type="hidden" name="client_secret" th:value="${param.client_secret}"/>
                <input type="text" th:value="${'Phone Number：' + mobile}" readonly class="form-control login-item"/>
                <input type="text" name="sms" value="" required="required" oninvalid="setCustomValidity('Please enter code');" oninput="setCustomValidity('');"  class="form-control code" placeholder="Security Code"/>
                <button type="button" class="form-control sendCode" id="sendCode">Send</button>
                <input class="login-submit" type="submit" value="Login"/>
                <a class="forgetPwd-txt link-forget">Forgot Password？</a>
            </form>
        </div>
    </div>
    <div class="app-footer">
        <div class="app-introduce">
            Copyright © 2017-2019 MOF Securities Co Ltd. All rights reserved.
        </div>
    </div>
</div>
</body>
<script>
    $(function(){
        $(".link-index").each(function () {
            $(this).attr("href", "http://" + window.location.hostname.replace('auth', 'www'));
        });
        $(".link-forget").each(function () {
            $(this).attr("href", "http://" + window.location.hostname.replace('auth', 'www') + "/forgetPwd");
        });
        $(".link-register").each(function () {
            $(this).attr("href", "http://" + window.location.hostname.replace('auth', 'www') + "/register");
        });

        $(".app-container").height(window.innerHeight - 58 + 'px');
    });

    function countTime(object) {
        var count = 60;
        var timer = window.setInterval(function () {
            if (count > 0) {
                $("#"+object).html(count + 's');
                $("#"+object).attr('disabled', true);
                count--;
            } else {
                $("#"+object).html('Send');
                $("#"+object).attr('disabled', false);
                window.clearInterval(timer);
            }
        }, 1000);
    }

    $("#sendCode").on("click", function () {
        $.ajax({
            cache: true,
            type: 'POST',
            url: "/oauth/sendSms",
            beforeSend: function () {
                $(this).attr("disabled", true);
            },
            success: function (data) {
                if (data.code === 200 || data.code === 2011) {
                    countTime('sendCode');
                }
            },
            complete: function () {
                $(this).attr("disabled", false);
            }
        });
    });
</script>
</html>